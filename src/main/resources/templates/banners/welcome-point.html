<!--<!DOCTYPE html>-->
<!--<html xmlns:th="http://www.thymeleaf.org" lang="ko">-->
<!--<head>-->
<!--    <meta charset="UTF-8">-->
<!--    <meta name="viewport" content="width=device-width, initial-scale=1.0">-->
<!--    <title>μ›°μ»΄ ν¬μΈνΈ</title>-->
<!--    <link rel="stylesheet" href="/css/welcome-point.css">-->
<!--    &lt;!&ndash; π”΄ CSS λ΅λ”© ν™•μΈμ© &ndash;&gt;-->
<!--    <script>-->
<!--        console.log('νμ΄μ§€ λ΅λ“ μ‹μ‘');-->
<!--        window.addEventListener('load', () => {-->
<!--            console.log('νμ΄μ§€ λ΅λ“ μ™„λ£');-->
<!--            const modal = document.getElementById('alertModal');-->
<!--            const styles = window.getComputedStyle(modal);-->
<!--            console.log('λ¨λ‹¬ display:', styles.display);-->
<!--            console.log('λ¨λ‹¬ opacity:', styles.opacity);-->
<!--        });-->
<!--    </script>-->
<!--</head>-->
<!--<body>-->

<!--<div class="page-container">-->
<!--    <div class="page-main">-->
<!--        <img src="/images/banners/welcome-point/main.svg" alt="μ‹ κ· κ°€μ…μ μ›°μ»΄ ν¬μΈνΈ 500p">-->
<!--    </div>-->

<!--    <div class="page-button">-->
<!--        <button id="claimButton">-->
<!--            <img src="/images/banners/welcome-point/button.svg" alt="ν¬μΈνΈ λ°›κΈ°">-->
<!--        </button>-->
<!--    </div>-->

<!--    <div class="page-line"></div>-->

<!--    <div class="page-comments">-->
<!--        <div class="page-comments-title">μ μμ‚¬ν•­</div>-->
<!--        <ul>-->
<!--            <li>μ‹ κ· κ°€μ…μλ§ ν¬μΈνΈλ¥Ό μ–»μ„ μ μμ</li>-->
<!--            <li>μ‹ κ· κ°€μ…μμ— ν•ν•΄μ„ κ°€μ… ν›„ ν• λ²λ§ ν¬μΈνΈ λ°›κΈ° κ°€λ¥</li>-->
<!--            <li>λ½‘κΈ° κΈ°λ¥μ—μ„ μ‚¬μ© λ°”λ΅ κ°€λ¥ν•¨</li>-->
<!--            <li>λ°›μ€ ν¬μΈνΈλ” μ„ λ¬Όν•κ±°λ‚ μ–‘λ„κ°€ λ¶κ°€λ¥ν•¨</li>-->
<!--        </ul>-->
<!--    </div>-->

<!--    <div id="alertModal" class="modal-overlay">-->
<!--        <div class="modal-content">-->
<!--            <img id="alertImage" src="" alt="μ•λ¦Ό">-->
<!--        </div>-->
<!--    </div>-->
<!--</div>-->

<!--<script th:inline="javascript">-->
<!--    const claimButton = document.getElementById('claimButton');-->
<!--    const modal = document.getElementById('alertModal');-->
<!--    const alertImage = document.getElementById('alertImage');-->

<!--    claimButton.addEventListener('click', () => {-->
<!--        const token = window.accessToken || /*[[${accessToken}]]*/ '';-->
<!--        console.log('π”΄ μ‚¬μ©ν•  ν† ν°:', token ? 'ν† ν° μμ' : 'ν† ν° μ—†μ');-->

<!--        fetch('/api/events/welcome-point', {-->
<!--            method: 'POST',-->
<!--            headers: {-->
<!--                'Authorization': `${token}`,-->
<!--                'Content-Type': 'application/json'-->
<!--            }-->
<!--        })-->
<!--            .then(res => {-->
<!--                if (!res.ok) {-->
<!--                    throw new Error('μ„λ²„ μ‘λ‹µ μ¤λ¥');-->
<!--                }-->
<!--                return res.json();-->
<!--            })-->
<!--            .then(data => {-->
<!--                console.log("μ„λ²„ μ‘λ‹µ:", JSON.stringify(data));-->

<!--                if (data.participationCompleted) {-->
<!--                    console.log('π”΄ μ΄λ²¤νΈ μ°Έμ—¬ μ™„λ£ - success μ΄λ―Έμ§€');-->
<!--                    alertImage.src = '/images/banners/welcome-point/success_alert.svg';-->
<!--                } else {-->
<!--                    console.log('π”΄ μ΄λ―Έ μ°Έμ—¬ μ™„λ£ - fail μ΄λ―Έμ§€');-->
<!--                    alertImage.src = '/images/banners/welcome-point/fail_alert.svg';-->
<!--                }-->

<!--                console.log('π”΄ λ¨λ‹¬μ— active ν΄λμ¤ μ¶”κ°€ μ‹μ‘');-->
<!--                modal.classList.add('active');-->
<!--                console.log('π”΄ λ¨λ‹¬ ν΄λμ¤:', modal.className);-->
<!--                console.log('π”΄ λ¨λ‹¬ μ¤νƒ€μΌ:', window.getComputedStyle(modal).display);-->
<!--            })-->
<!--            .catch(err => {-->
<!--                console.error('μ—λ¬:', err);-->
<!--                alertImage.src = '/images/banners/welcome-point/fail_alert.svg';-->
<!--                modal.classList.add('active');-->
<!--            });-->
<!--    });-->

<!--    // λ¨λ‹¬ λ‹«κΈ°-->
<!--    modal.addEventListener('click', (event) => {-->
<!--        if (event.target === modal) {-->
<!--            modal.classList.remove('active');-->
<!--        }-->
<!--    });-->
<!--</script>-->
<!--</body>-->
<!--</html>-->


<!DOCTYPE html>
<html xmlns:th="http://www.thymeleaf.org" lang="ko">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>μ›°μ»΄ ν¬μΈνΈ</title>
    <link rel="stylesheet" href="/css/welcome-point.css">

    <!-- π”΄ CSS λ΅λ”© ν™•μΈμ© -->
    <script>
        console.log('νμ΄μ§€ λ΅λ“ μ‹μ‘');
        window.addEventListener('load', () => {
            console.log('νμ΄μ§€ λ΅λ“ μ™„λ£');
            const modal = document.getElementById('alertModal');
            const styles = window.getComputedStyle(modal);
            console.log('λ¨λ‹¬ display:', styles.display);
            console.log('λ¨λ‹¬ opacity:', styles.opacity);
        });
    </script>

    <!-- π”΄ ν…μ¤νΈ ν…μ¤νΈμ© μΈλΌμΈ μ¤νƒ€μΌ -->
    <style>
        .alert-text {
            background: white;
            padding: 40px;
            border-radius: 16px;
            text-align: center;
            font-size: 20px;
            font-weight: bold;
            box-shadow: 0 4px 12px rgba(0, 0, 0, 0.15);
        }

        .alert-text.success {
            color: #22c55e;
            border: 3px solid #22c55e;
        }

        .alert-text.fail {
            color: #ef4444;
            border: 3px solid #ef4444;
        }
    </style>
</head>
<body>

<div class="page-container">
    <div class="page-main">
        <img src="/images/banners/welcome-point/main.svg" alt="μ‹ κ· κ°€μ…μ μ›°μ»΄ ν¬μΈνΈ 500p">
    </div>

    <div class="page-button">
        <button id="claimButton">
            <img src="/images/banners/welcome-point/button.svg" alt="ν¬μΈνΈ λ°›κΈ°">
        </button>
    </div>

    <div class="page-line"></div>

    <div class="page-comments">
        <div class="page-comments-title">μ μμ‚¬ν•­</div>
        <ul>
            <li>μ‹ κ· κ°€μ…μλ§ ν¬μΈνΈλ¥Ό μ–»μ„ μ μμ</li>
            <li>μ‹ κ· κ°€μ…μμ— ν•ν•΄μ„ κ°€μ… ν›„ ν• λ²λ§ ν¬μΈνΈ λ°›κΈ° κ°€λ¥</li>
            <li>λ½‘κΈ° κΈ°λ¥μ—μ„ μ‚¬μ© λ°”λ΅ κ°€λ¥ν•¨</li>
            <li>λ°›μ€ ν¬μΈνΈλ” μ„ λ¬Όν•κ±°λ‚ μ–‘λ„κ°€ λ¶κ°€λ¥ν•¨</li>
        </ul>
    </div>

    <div id="alertModal" class="modal-overlay">
        <div class="modal-content">
            <div id="alertText" class="alert-text">
            </div>
        </div>
    </div>
</div>

<script th:inline="javascript">
    const claimButton = document.getElementById('claimButton');
    const modal = document.getElementById('alertModal');
    const alertText = document.getElementById('alertText');

    claimButton.addEventListener('click', () => {
        console.log('π”΄ ν¬μΈνΈ λ°›κΈ° λ²„νΌ ν΄λ¦­λ¨');
        const token = window.accessToken || /*[[${accessToken}]]*/ '';
        console.log('π”΄ μ‚¬μ©ν•  ν† ν°:', token ? 'ν† ν° μμ' : 'ν† ν° μ—†μ');

        fetch('/api/events/welcome-point', {
            method: 'POST',
            headers: {
                'Authorization': `${token}`,
                'Content-Type': 'application/json'
            }
        })
            .then(res => {
                console.log('π”΄ μ„λ²„ μ‘λ‹µ μƒνƒ:', res.status);
                if (!res.ok) {
                    throw new Error('μ„λ²„ μ‘λ‹µ μ¤λ¥');
                }
                return res.json();
            })
            .then(data => {
                console.log("π”΄ μ„λ²„ μ‘λ‹µ:", JSON.stringify(data));

                // π”΄ μ΄λ―Έμ§€ λ€μ‹  ν…μ¤νΈμ™€ ν΄λμ¤λ΅ ν‘μ‹
                if (data.participationCompleted) {
                    console.log('π”΄ μ΄λ²¤νΈ μ°Έμ—¬ μ™„λ£ - SUCCESS');
                    alertText.textContent = 'β… ν¬μΈνΈ μ§€κΈ‰ μ™„λ£!\n500Pκ°€ μ§€κΈ‰λμ—μµλ‹λ‹¤.';
                    alertText.className = 'alert-text success';
                } else {
                    console.log('π”΄ μ΄λ―Έ μ°Έμ—¬ μ™„λ£ - FAIL');
                    alertText.textContent = 'β μ΄λ―Έ μ°Έμ—¬ν•μ…¨μµλ‹λ‹¤\nμ¤‘λ³µ μ°Έμ—¬λ” λ¶κ°€λ¥ν•©λ‹λ‹¤.';
                    alertText.className = 'alert-text fail';
                }

                console.log('π”΄ λ¨λ‹¬μ— active ν΄λμ¤ μ¶”κ°€ μ‹μ‘');
                modal.classList.add('active');
                console.log('π”΄ λ¨λ‹¬ ν΄λμ¤:', modal.className);
                console.log('π”΄ λ¨λ‹¬ μ¤νƒ€μΌ:', window.getComputedStyle(modal).display);
            })
            .catch(err => {
                console.error('π”΄ μ—λ¬:', err);
                alertText.textContent = 'β οΈ μ¤λ¥ λ°μƒ\nλ‹¤μ‹ μ‹λ„ν•΄μ£Όμ„Έμ”.';
                alertText.className = 'alert-text fail';
                modal.classList.add('active');
            });
    });

    // λ¨λ‹¬ λ‹«κΈ°
    modal.addEventListener('click', (event) => {
        if (event.target === modal) {
            console.log('π”΄ λ¨λ‹¬ λ‹«κΈ°');
            modal.classList.remove('active');
        }
    });
</script>
</body>
</html>